Training with configuration:
data:
  colormode: RGB
  inference:
    normalize_images: True
  train:
    affine:
      p: 0.5
      rotation: 30
      scaling: [1.0, 1.0]
      translation: 0
    collate:
      type: ResizeFromDataSizeCollate
      min_scale: 0.4
      max_scale: 1.0
      min_short_side: 128
      max_short_side: 1152
      multiple_of: 32
      to_square: False
    covering: False
    gaussian_noise: 12.75
    hist_eq: False
    motion_blur: False
    normalize_images: True
device: auto
metadata:
  project_path: /local/data2/LIA_LIU_PONTUS/LIA_LIU/res_101_epoch_100-conv_vid-2024-11-06
  pose_config_path: /local/data2/LIA_LIU_PONTUS/LIA_LIU/res_101_epoch_100-conv_vid-2024-11-06/dlc-models-pytorch/iteration-1/res_101_epoch_100Nov6-trainset90shuffle1/train/pose_cfg.yaml
  bodyparts: ['FR1', 'FR2', 'FG1', 'FG2', 'FB1', 'FB2', 'Top_left', 'Top_right', 'Bottom_left', 'Bottom_right']
  unique_bodyparts: []
  individuals: ['animal']
  with_identity: None
method: bu
model:
  backbone:
    type: ResNet
    model_name: resnet101
    output_stride: 16
    freeze_bn_stats: True
    freeze_bn_weights: False
  backbone_output_channels: 2048
  heads:
    bodypart:
      type: HeatmapHead
      weight_init: normal
      predictor:
        type: HeatmapPredictor
        apply_sigmoid: False
        clip_scores: True
        location_refinement: True
        locref_std: 7.2801
      target_generator:
        type: HeatmapGaussianGenerator
        num_heatmaps: 10
        pos_dist_thresh: 17
        heatmap_mode: KEYPOINT
        gradient_masking: False
        generate_locref: True
        locref_std: 7.2801
      criterion:
        heatmap:
          type: WeightedMSECriterion
          weight: 1.0
        locref:
          type: WeightedHuberCriterion
          weight: 0.05
      heatmap_config:
        channels: [2048, 10]
        kernel_size: [3]
        strides: [2]
      locref_config:
        channels: [2048, 20]
        kernel_size: [3]
        strides: [2]
net_type: resnet_101
runner:
  type: PoseTrainingRunner
  gpus: None
  key_metric: test.mAP
  key_metric_asc: True
  eval_interval: 10
  optimizer:
    type: AdamW
    params:
      lr: 5e-05
  scheduler:
    type: LRListScheduler
    params:
      lr_list: [[1e-05], [1e-06]]
      milestones: [160, 190]
  snapshots:
    max_snapshots: 5
    save_epochs: 25
    save_optimizer_state: False
train_settings:
  batch_size: 2
  dataloader_workers: 0
  dataloader_pin_memory: False
  display_iters: 500
  epochs: 100
  seed: 42
Loading pretrained weights from Hugging Face hub (timm/resnet101.a1h_in1k)
[timm/resnet101.a1h_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
Data Transforms:
  Training:   Compose([
  Affine(always_apply=False, p=0.5, interpolation=1, mask_interpolation=0, cval=0, mode=0, scale={'x': (1.0, 1.0), 'y': (1.0, 1.0)}, translate_percent=None, translate_px={'x': (0, 0), 'y': (0, 0)}, rotate=(-30, 30), fit_output=False, shear={'x': (0.0, 0.0), 'y': (0.0, 0.0)}, cval_mask=0, keep_ratio=True, rotate_method='largest_box'),
  GaussNoise(always_apply=False, p=0.5, var_limit=(0, 162.5625), per_channel=True, mean=0),
  Normalize(always_apply=False, p=1.0, mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], max_pixel_value=255.0),
], p=1.0, bbox_params={'format': 'coco', 'label_fields': ['bbox_labels'], 'min_area': 0.0, 'min_visibility': 0.0, 'min_width': 0.0, 'min_height': 0.0, 'check_each_transform': True}, keypoint_params={'format': 'xy', 'label_fields': ['class_labels'], 'remove_invisible': False, 'angle_in_degrees': True, 'check_each_transform': True}, additional_targets={}, is_check_shapes=True)
  Validation: Compose([
  Normalize(always_apply=False, p=1.0, mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225], max_pixel_value=255.0),
], p=1.0, bbox_params={'format': 'coco', 'label_fields': ['bbox_labels'], 'min_area': 0.0, 'min_visibility': 0.0, 'min_width': 0.0, 'min_height': 0.0, 'check_each_transform': True}, keypoint_params={'format': 'xy', 'label_fields': ['class_labels'], 'remove_invisible': False, 'angle_in_degrees': True, 'check_each_transform': True}, additional_targets={}, is_check_shapes=True)
Using custom collate function: {'type': 'ResizeFromDataSizeCollate', 'min_scale': 0.4, 'max_scale': 1.0, 'min_short_side': 128, 'max_short_side': 1152, 'multiple_of': 32, 'to_square': False}

Note: According to your model configuration, you're training with batch size 1 and/or ``freeze_bn_stats=false``. This is not an optimal setting if you have powerful GPUs.
This is good for small batch sizes (e.g., when training on a CPU), where you should keep ``freeze_bn_stats=true``.
If you're using a GPU to train, you can obtain faster performance by setting a larger batch size (the biggest power of 2 where you don't geta CUDA out-of-memory error, such as 8, 16, 32 or 64 depending on the model, size of your images, and GPU memory) and ``freeze_bn_stats=false`` for the backbone of your model. 
This also allows you to increase the learning rate (empirically you can scale the learning rate by sqrt(batch_size) times).

Using 468 images and 52 for testing

Starting pose model training...
--------------------------------------------------
Epoch 1/100 (lr=5e-05), train loss 0.01037
Epoch 2/100 (lr=5e-05), train loss 0.00475
Epoch 3/100 (lr=5e-05), train loss 0.00348
Epoch 4/100 (lr=5e-05), train loss 0.00285
Epoch 5/100 (lr=5e-05), train loss 0.00250
Epoch 6/100 (lr=5e-05), train loss 0.00224
Epoch 7/100 (lr=5e-05), train loss 0.00206
Epoch 8/100 (lr=5e-05), train loss 0.00184
Epoch 9/100 (lr=5e-05), train loss 0.00173
Training for epoch 10 done, starting evaluation
Epoch 10 performance:
metrics/test.rmse:  4.500
metrics/test.rmse_pcutoff:3.233
metrics/test.mAP:   94.642
metrics/test.mAR:   96.923
metrics/test.rmse_detections:4.500
metrics/test.rmse_detections_pcutoff:3.233
Epoch 10/100 (lr=5e-05), train loss 0.00162, valid loss 0.00134
Epoch 11/100 (lr=5e-05), train loss 0.00156
Epoch 12/100 (lr=5e-05), train loss 0.00146
Epoch 13/100 (lr=5e-05), train loss 0.00135
Epoch 14/100 (lr=5e-05), train loss 0.00126
Epoch 15/100 (lr=5e-05), train loss 0.00133
Epoch 16/100 (lr=5e-05), train loss 0.00120
Epoch 17/100 (lr=5e-05), train loss 0.00117
Epoch 18/100 (lr=5e-05), train loss 0.00120
Epoch 19/100 (lr=5e-05), train loss 0.00110
Training for epoch 20 done, starting evaluation
Epoch 20 performance:
metrics/test.rmse:  4.060
metrics/test.rmse_pcutoff:3.151
metrics/test.mAP:   95.818
metrics/test.mAR:   97.115
metrics/test.rmse_detections:4.060
metrics/test.rmse_detections_pcutoff:3.151
Epoch 20/100 (lr=5e-05), train loss 0.00106, valid loss 0.00109
Epoch 21/100 (lr=5e-05), train loss 0.00105
Epoch 22/100 (lr=5e-05), train loss 0.00100
Epoch 23/100 (lr=5e-05), train loss 0.00101
Epoch 24/100 (lr=5e-05), train loss 0.00094
Epoch 25/100 (lr=5e-05), train loss 0.00089
Epoch 26/100 (lr=5e-05), train loss 0.00089
Epoch 27/100 (lr=5e-05), train loss 0.00089
Epoch 28/100 (lr=5e-05), train loss 0.00087
Epoch 29/100 (lr=5e-05), train loss 0.00084
Training for epoch 30 done, starting evaluation
Epoch 30 performance:
metrics/test.rmse:  4.378
metrics/test.rmse_pcutoff:2.501
metrics/test.mAP:   98.060
metrics/test.mAR:   98.846
metrics/test.rmse_detections:4.378
metrics/test.rmse_detections_pcutoff:2.501
Epoch 30/100 (lr=5e-05), train loss 0.00083, valid loss 0.00093
Epoch 31/100 (lr=5e-05), train loss 0.00085
Epoch 32/100 (lr=5e-05), train loss 0.00079
Epoch 33/100 (lr=5e-05), train loss 0.00078
Epoch 34/100 (lr=5e-05), train loss 0.00077
Epoch 35/100 (lr=5e-05), train loss 0.00077
Epoch 36/100 (lr=5e-05), train loss 0.00075
Epoch 37/100 (lr=5e-05), train loss 0.00071
Epoch 38/100 (lr=5e-05), train loss 0.00076
Epoch 39/100 (lr=5e-05), train loss 0.00070
Training for epoch 40 done, starting evaluation
Epoch 40 performance:
metrics/test.rmse:  4.381
metrics/test.rmse_pcutoff:2.232
metrics/test.mAP:   97.742
metrics/test.mAR:   98.462
metrics/test.rmse_detections:4.381
metrics/test.rmse_detections_pcutoff:2.232
Epoch 40/100 (lr=5e-05), train loss 0.00069, valid loss 0.00073
Epoch 41/100 (lr=5e-05), train loss 0.00068
Epoch 42/100 (lr=5e-05), train loss 0.00068
Epoch 43/100 (lr=5e-05), train loss 0.00062
Epoch 44/100 (lr=5e-05), train loss 0.00065
Epoch 45/100 (lr=5e-05), train loss 0.00063
Epoch 46/100 (lr=5e-05), train loss 0.00062
Epoch 47/100 (lr=5e-05), train loss 0.00066
Epoch 48/100 (lr=5e-05), train loss 0.00061
Epoch 49/100 (lr=5e-05), train loss 0.00063
Training for epoch 50 done, starting evaluation
Epoch 50 performance:
metrics/test.rmse:  2.233
metrics/test.rmse_pcutoff:2.001
metrics/test.mAP:   99.206
metrics/test.mAR:   99.423
metrics/test.rmse_detections:2.233
metrics/test.rmse_detections_pcutoff:2.001
Epoch 50/100 (lr=5e-05), train loss 0.00067, valid loss 0.00069
Epoch 51/100 (lr=5e-05), train loss 0.00062
Epoch 52/100 (lr=5e-05), train loss 0.00057
Epoch 53/100 (lr=5e-05), train loss 0.00059
Epoch 54/100 (lr=5e-05), train loss 0.00054
Epoch 55/100 (lr=5e-05), train loss 0.00059
Epoch 56/100 (lr=5e-05), train loss 0.00057
Epoch 57/100 (lr=5e-05), train loss 0.00058
Epoch 58/100 (lr=5e-05), train loss 0.00058
Epoch 59/100 (lr=5e-05), train loss 0.00057
Training for epoch 60 done, starting evaluation
Epoch 60 performance:
metrics/test.rmse:  3.717
metrics/test.rmse_pcutoff:1.834
metrics/test.mAP:   99.471
metrics/test.mAR:   99.615
metrics/test.rmse_detections:3.717
metrics/test.rmse_detections_pcutoff:1.834
Epoch 60/100 (lr=5e-05), train loss 0.00055, valid loss 0.00068
Epoch 61/100 (lr=5e-05), train loss 0.00054
Epoch 62/100 (lr=5e-05), train loss 0.00055
Epoch 63/100 (lr=5e-05), train loss 0.00054
Epoch 64/100 (lr=5e-05), train loss 0.00051
Epoch 65/100 (lr=5e-05), train loss 0.00050
Epoch 66/100 (lr=5e-05), train loss 0.00051
Epoch 67/100 (lr=5e-05), train loss 0.00053
Epoch 68/100 (lr=5e-05), train loss 0.00049
Epoch 69/100 (lr=5e-05), train loss 0.00051
Training for epoch 70 done, starting evaluation
Epoch 70 performance:
metrics/test.rmse:  3.867
metrics/test.rmse_pcutoff:1.867
metrics/test.mAP:   99.026
metrics/test.mAR:   99.231
metrics/test.rmse_detections:3.867
metrics/test.rmse_detections_pcutoff:1.867
Epoch 70/100 (lr=5e-05), train loss 0.00050, valid loss 0.00064
Epoch 71/100 (lr=5e-05), train loss 0.00051
Epoch 72/100 (lr=5e-05), train loss 0.00045
Epoch 73/100 (lr=5e-05), train loss 0.00050
Epoch 74/100 (lr=5e-05), train loss 0.00048
Epoch 75/100 (lr=5e-05), train loss 0.00048
Epoch 76/100 (lr=5e-05), train loss 0.00050
Epoch 77/100 (lr=5e-05), train loss 0.00046
Epoch 78/100 (lr=5e-05), train loss 0.00046
Epoch 79/100 (lr=5e-05), train loss 0.00045
Training for epoch 80 done, starting evaluation
Epoch 80 performance:
metrics/test.rmse:  1.811
metrics/test.rmse_pcutoff:1.595
metrics/test.mAP:   100.000
metrics/test.mAR:   100.000
metrics/test.rmse_detections:1.811
metrics/test.rmse_detections_pcutoff:1.595
Epoch 80/100 (lr=5e-05), train loss 0.00044, valid loss 0.00060
Epoch 81/100 (lr=5e-05), train loss 0.00046
Epoch 82/100 (lr=5e-05), train loss 0.00044
Epoch 83/100 (lr=5e-05), train loss 0.00043
Epoch 84/100 (lr=5e-05), train loss 0.00045
Epoch 85/100 (lr=5e-05), train loss 0.00043
Epoch 86/100 (lr=5e-05), train loss 0.00044
Epoch 87/100 (lr=5e-05), train loss 0.00042
Epoch 88/100 (lr=5e-05), train loss 0.00041
Epoch 89/100 (lr=5e-05), train loss 0.00042
Training for epoch 90 done, starting evaluation
Epoch 90 performance:
metrics/test.rmse:  1.913
metrics/test.rmse_pcutoff:1.660
metrics/test.mAP:   99.772
metrics/test.mAR:   99.808
metrics/test.rmse_detections:1.913
metrics/test.rmse_detections_pcutoff:1.660
Epoch 90/100 (lr=5e-05), train loss 0.00046, valid loss 0.00060
Epoch 91/100 (lr=5e-05), train loss 0.00047
Epoch 92/100 (lr=5e-05), train loss 0.00043
Epoch 93/100 (lr=5e-05), train loss 0.00041
Epoch 94/100 (lr=5e-05), train loss 0.00041
Epoch 95/100 (lr=5e-05), train loss 0.00041
Epoch 96/100 (lr=5e-05), train loss 0.00039
Epoch 97/100 (lr=5e-05), train loss 0.00039
Epoch 98/100 (lr=5e-05), train loss 0.00039
Epoch 99/100 (lr=5e-05), train loss 0.00041
Training for epoch 100 done, starting evaluation
Epoch 100 performance:
metrics/test.rmse:  1.866
metrics/test.rmse_pcutoff:1.696
metrics/test.mAP:   100.000
metrics/test.mAR:   100.000
metrics/test.rmse_detections:1.866
metrics/test.rmse_detections_pcutoff:1.696
Epoch 100/100 (lr=5e-05), train loss 0.00041, valid loss 0.00059
Loading DLC 3.0.0rc5...
